<html>
<head>
  <style type="text/css">
    .blockL{
      border: 1px solid;
      border-bottom: none;
      float: left;
      width: 384px;
      height: 10;
      font-size: small;
      line-height: 0.7em;
    }
    .blockR{
      border: 1px solid;
      border-bottom: none;
      float: right;
      width: 384px;
      height: 10;
      font-size: small;
      line-height:.7em;
    }
    table{
      border-spacing: 0;
    }
    .container{
      width: 900px;
      padding-left: 50px;
      /*border: 1px solid;*/
      
    }
    h1{
      text-align: center;
      line-height: .5em;
      font-size:26.6667px;
    }
    h2{
      text-align: center;
      line-height: 0em;
      font-size:16px;
    }
    h3{
      transform-origin: 0 0;
      transform: rotate(-90deg) translateX(-200%);
      position: absolute;
      font-size: 16px;
    }
    .legend{
      font-size: 10px;
      line-height: 0;
    }
    canvas{
      align-self: center;
    }
    input[type=text],
    input[type=number],
    input[type=date],
    select{
      width: 100px !important;
    }
    .pageborder {
      position: fixed;
      overflow: auto;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      border: 1px solid black;
      display: none;
    }
    @page{
      margin-top: .25in;
      margin-bottom: .25in;
      margin-left: .25in;
      margin-right: .25in;
    }
    @media print{
      .nonprint, .nonprint *{
        display: none !important;
      }
      .container{
       page-break-after: always;
      }
      .pageborder{
        display: unset !important;
      }
    }
  </style>
</head>
<body onload="toggleConfig()">
  <div class="nonprint">
    <table><tr>
      <td>Select File(s) to Load: &emsp;</td>
      <td><input type="file" id="fileToLoad"></td>
    </tr></table>
    <table>
      <tr>
        <td><input type="text" id="input1">Title</input></td>
        <td><input type="text" id="input2">Subtitle</input></td>
        <td><input type="text" value="CI Survey - Volts" disabled id="input3">Y-axis</input></td>
        <td><input type="text" style="display: none;" value="" disabled id="input4"></input></td>
      </tr>
      <tr>
        <td><input type="text" id="input5">Location&emsp;</input></td>
        <td><select id="input6">
          <option value="--->>>">--->>></option>
          <option value="<<<---"><<<---</option>
        </select>Direction</td>
        <td><input type="text" value="On-Interrupted" id="input7">Survey Type&emsp;</input></td>
        <td><input type="text" id="input8">Survey Date</input></td>
      </tr>
      <tr>
        <td><input type="text" value="3-ON / 1-OFF" id="input9">Cycle</input></td>
        <td><input type="text" value="1500ms" id="input10">On Setup&emsp;</input></td>
        <td><input type="text" value="750ms" id="input11">Off Delay</input></td>
        <td><input type="text" value="OFF" id="input12">Cycle Begins With</input></td>
      </tr>
      <tr>
        <td><button onclick="drawLines();drawComments('black')">Generate Graph</button></td>
        <td><button onclick="loadFile();">Initialize Graph</button></td>
      </tr>
    </table>
    <input type="checkbox" onclick="toggleConfig()" id="toggleConfig"/>
    <label for="toggleConfig">Show Config</label>
    <table style="display:none" id="config">
      <tr>
        <td><input type="number" value="9" id="config1">Font Size</input></td>
        <td><select id="config2">
          <option value=4>25</option>
          <option value=2>50</option>
          <option value=1 selected>100</option>
        </select>Feet/Inch</td>
        <td><select value="96" id="config3">
          <option value=24>24</option>
          <option value="48">48</option>
          <option value="96" selected>96</option>
          <option value="192">192</option>
        </select>Pixel per Bar</td>
        <td><input type="number" value=5 min=0 id="config4">Skip Read Threshold</input></td>
      </tr>
      <tr>
          <td><input type="number" id="config13" value="0">Start At Foot</input></td>
          <td><input type="number" id="config14" value="0">End At Foot</input></td>
          <td><input type="number" id="config15" value="96"/>DPI</td>
      </tr>
      <tr>
        <td><input type="text" value=".5" id="config5">Mininum Voltage</input></td>
        <td><input type="text" value="-2.525" id="config6">Maximum Voltage</input></td>
        <td><input type="text" value=".2" id="config7">Voltage Increment</input></td>
        <td><input type="number" min="1" max="6" value="2" id="config8">Number of Trend Lines</input></td>
      </tr>
      <tr>
        <td><input type="text" value="-.85" id="config9">Reference Line 1 Voltage</input></td>
        <td><input type="text" value="red"  id="config10">Reference Line 1 Color</input></td>
        <td><input type="text" value="-1.2" id="config11">Reference Line 2 Voltage</input></td>
        <td><input type="text" value="gray" id="config12">Reference Line 2 Color</input></td>
      </tr>
      <tr>
        <td><input type="text" value="ON" id="lineName0">Line 1 Name</input></td>
        <td><select type="text" id="lineColor0">
          <option value="#32cd32" selected>Green</option>
          <option value="blue">Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 1 Color</td>
        <td><input type="text" value="OFF" id="lineName1">Line 2 Name</input></td>
        <td><select type="text" id="lineColor1">
          <option value="#32cd32">Green</option>
          <option value="blue" selected>Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 2 Color</td>
      </tr>
      <tr>
        <td><input type="text" id="lineName2">Line 3 Name</input></td>
        <td><select type="text" id="lineColor2">
          <option value="#32cd32">Green</option>
          <option value="blue">Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 3 Color</td>
        <td><input type="text" id="lineName3">Line 4 Name</input></td>
        <td><select type="text" id="lineColor3">
          <option value="#32cd32">Green</option>
          <option value="blue">Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 4 Color</td>
      </tr>
      <tr>
        <td><input type="text" id="lineName4">Line 5 Name</input></td>
        <td><select type="text" id="lineColor4">
          <option value="#32cd32">Green</option>
          <option value="blue">Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 5 Color</td>
        <td><input type="text" id="lineName5">Line 6 Name</input></td>
        <td><select type="text" id="lineColor5">
          <option value="#32cd32">Green</option>
          <option value="blue">Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 6 Color</td>
      </tr>
      <tr>
        <td><input type="text" id="lineName6">Line 7 Name</input></td>
        <td><select type="text" id="lineColor6">
          <option value="#32cd32">Green</option>
          <option value="blue">Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 7 Color</td>
        <td><input type="text" id="lineName7">Line 8 Name</input></td>
        <td><select type="text" id="lineColor7">
          <option value="#32cd32">Green</option>
          <option value="blue">Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 8 Color</td>
      </tr>
      <tr>
        <td><input type="text" id="lineName8">Line 9 Name</input></td>
        <td><select type="text" id="lineColor8">
          <option value="#32cd32">Green</option>
          <option value="blue">Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 9 Color</td>
        <td><input type="text" id="lineName9">Line 10 Name</input></td>
        <td><select type="text" id="lineColor9">
          <option value="#32cd32">Green</option>
          <option value="blue">Blue</option>
          <option value="black">Black</option>
          <option value="brown">Brown</option>
          </select>Line 10 Color</td>
      </tr>
    </table>
  </div>
  <div id="printer">
    <div id="container0" class="container">
      <div class="pageborder"></div>
      <br style="line-height: 5px;"/>
      <h1 id=box1></h1>
      <h2 id=box2></h2>
      <h3 id=box3 style="display: none;"></h3>
      &emsp;&emsp;&emsp;&emsp;
      <span id="legend0" class="legend" style="display:none">___</span>
      <span id="legend1" class="legend" style="display:none">___</span>
      <span id="legend2" class="legend" style="display:none">___</span>
      <span id="legend3" class="legend" style="display:none">___</span>
      <span id="legend4" class="legend" style="display:none">___</span>
      <span id="legend5" class="legend" style="display:none">___</span>
      <span id="legend6" class="legend" style="display:none">___</span>
      <span id="legend7" class="legend" style="display:none">___</span>
      <span id="legend8" class="legend" style="display:none">___</span>
      <span id="legend9" class="legend" style="display:none">___</span>
      
      <canvas id="canvas0" width="900" height="600"></canvas>
      <table width="864">
        <tr>
          <td class="blockL" id=box13>Feet/Inch</td>
          <td class="blockR" id=box4><span id="pageNumber">Page 1</span></td>
        </tr>
        <tr>
          <td class="blockL" id=box5>Location: </td>
          <td class="blockR" id=box9>Interruption Cycle: </td>
        </tr>
        <tr>
          <td class="blockL" id=box6>Survey Direction: </td>
          <td class="blockR" id=box10>On Setup: </td>
        </tr>
        <tr>
          <td class="blockL" id=box7>Survey Type: </td>
          <td class="blockR" id=box11>Off Delay: </td>
        </tr>
        <tr>
          <td class="blockL" style="border-bottom: 1px solid;" id=box8>Survey Date: </td>
          <td class="blockR" style="border-bottom: 1px solid;" id=box12>Cycle Begins With: </td>
        </tr>
      </table>
      
    </div>
  </div>
</body>
<script type="text/javascript" >
/* @license
Papa Parse
v5.3.0
https://github.com/mholt/PapaParse
License: MIT
*/
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&"undefined"!=typeof exports?module.exports=t():e.Papa=t()}(this,function s(){"use strict";var f="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==f?f:{};var n=!f.document&&!!f.postMessage,o=n&&/blob:/i.test((f.location||{}).protocol),a={},h=0,b={parse:function(e,t){var i=(t=t||{}).dynamicTyping||!1;U(i)&&(t.dynamicTypingFunction=i,i={});if(t.dynamicTyping=i,t.transform=!!U(t.transform)&&t.transform,t.worker&&b.WORKERS_SUPPORTED){var r=function(){if(!b.WORKERS_SUPPORTED)return!1;var e=(i=f.URL||f.webkitURL||null,r=s.toString(),b.BLOB_URL||(b.BLOB_URL=i.createObjectURL(new Blob(["(",r,")();"],{type:"text/javascript"})))),t=new f.Worker(e);var i,r;return t.onmessage=m,t.id=h++,a[t.id]=t}();return r.userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=U(t.step),t.chunk=U(t.chunk),t.complete=U(t.complete),t.error=U(t.error),delete t.worker,void r.postMessage({input:e,config:t,workerId:r.id})}var n=null;b.NODE_STREAM_INPUT,"string"==typeof e?n=t.download?new l(t):new p(t):!0===e.readable&&U(e.read)&&U(e.on)?n=new g(t):(f.File&&e instanceof File||e instanceof Object)&&(n=new c(t));return n.stream(e)},unparse:function(e,t){var n=!1,m=!0,_=",",v="\r\n",s='"',a=s+s,i=!1,r=null,o=!1;!function(){if("object"!=typeof t)return;"string"!=typeof t.delimiter||b.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(_=t.delimiter);("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes);"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(i=t.skipEmptyLines);"string"==typeof t.newline&&(v=t.newline);"string"==typeof t.quoteChar&&(s=t.quoteChar);"boolean"==typeof t.header&&(m=t.header);if(Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");r=t.columns}void 0!==t.escapeChar&&(a=t.escapeChar+s);"boolean"==typeof t.escapeFormulae&&(o=t.escapeFormulae)}();var h=new RegExp(q(s),"g");"string"==typeof e&&(e=JSON.parse(e));if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,i);if("object"==typeof e[0])return f(r||u(e[0]),e,i)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:u(e.data[0])),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],i);throw new Error("Unable to serialize unrecognized input");function u(e){if("object"!=typeof e)return[];var t=[];for(var i in e)t.push(i);return t}function f(e,t,i){var r="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var n=Array.isArray(e)&&0<e.length,s=!Array.isArray(t[0]);if(n&&m){for(var a=0;a<e.length;a++)0<a&&(r+=_),r+=y(e[a],a);0<t.length&&(r+=v)}for(var o=0;o<t.length;o++){var h=n?e.length:t[o].length,u=!1,f=n?0===Object.keys(t[o]).length:0===t[o].length;if(i&&!n&&(u="greedy"===i?""===t[o].join("").trim():1===t[o].length&&0===t[o][0].length),"greedy"===i&&n){for(var d=[],l=0;l<h;l++){var c=s?e[l]:l;d.push(t[o][c])}u=""===d.join("").trim()}if(!u){for(var p=0;p<h;p++){0<p&&!f&&(r+=_);var g=n&&s?e[p]:p;r+=y(t[o][g],p)}o<t.length-1&&(!i||0<h&&!f)&&(r+=v)}}return r}function y(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);!0===o&&"string"==typeof e&&null!==e.match(/^[=+\-@].*$/)&&(e="'"+e);var i=e.toString().replace(h,a),r="boolean"==typeof n&&n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var i=0;i<t.length;i++)if(-1<e.indexOf(t[i]))return!0;return!1}(i,b.BAD_DELIMITERS)||-1<i.indexOf(_)||" "===i.charAt(0)||" "===i.charAt(i.length-1);return r?s+i+s:i}}};if(b.RECORD_SEP=String.fromCharCode(30),b.UNIT_SEP=String.fromCharCode(31),b.BYTE_ORDER_MARK="\ufeff",b.BAD_DELIMITERS=["\r","\n",'"',b.BYTE_ORDER_MARK],b.WORKERS_SUPPORTED=!n&&!!f.Worker,b.NODE_STREAM_INPUT=1,b.LocalChunkSize=10485760,b.RemoteChunkSize=5242880,b.DefaultDelimiter=",",b.Parser=w,b.ParserHandle=i,b.NetworkStreamer=l,b.FileStreamer=c,b.StringStreamer=p,b.ReadableStreamStreamer=g,f.jQuery){var d=f.jQuery;d.fn.parse=function(o){var i=o.config||{},h=[];return this.each(function(e){if(!("INPUT"===d(this).prop("tagName").toUpperCase()&&"file"===d(this).attr("type").toLowerCase()&&f.FileReader)||!this.files||0===this.files.length)return!0;for(var t=0;t<this.files.length;t++)h.push({file:this.files[t],inputElem:this,instanceConfig:d.extend({},i)})}),e(),this;function e(){if(0!==h.length){var e,t,i,r,n=h[0];if(U(o.before)){var s=o.before(n.file,n.inputElem);if("object"==typeof s){if("abort"===s.action)return e="AbortError",t=n.file,i=n.inputElem,r=s.reason,void(U(o.error)&&o.error({name:e},t,i,r));if("skip"===s.action)return void u();"object"==typeof s.config&&(n.instanceConfig=d.extend(n.instanceConfig,s.config))}else if("skip"===s)return void u()}var a=n.instanceConfig.complete;n.instanceConfig.complete=function(e){U(a)&&a(e,n.file,n.inputElem),u()},b.parse(n.file,n.instanceConfig)}else U(o.complete)&&o.complete()}function u(){h.splice(0,1),e()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=E(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null);this._handle=new i(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){if(this.isFirstChunk&&U(this._config.beforeFirstChunk)){var i=this._config.beforeFirstChunk(e);void 0!==i&&(e=i)}this.isFirstChunk=!1,this._halted=!1;var r=this._partialLine+e;this._partialLine="";var n=this._handle.parse(r,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=n.meta.cursor;this._finished||(this._partialLine=r.substring(s-this._baseIndex),this._baseIndex=s),n&&n.data&&(this._rowCount+=n.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)f.postMessage({results:n,workerId:b.WORKER_ID,finished:a});else if(U(this._config.chunk)&&!t){if(this._config.chunk(n,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);n=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),this._completed||!a||!U(this._config.complete)||n&&n.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),a||n&&n.meta.paused||this._nextChunk(),n}this._halted=!0},this._sendError=function(e){U(this._config.error)?this._config.error(e):o&&this._config.error&&f.postMessage({workerId:b.WORKER_ID,error:e,finished:!1})}}function l(e){var r;(e=e||{}).chunkSize||(e.chunkSize=b.RemoteChunkSize),u.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(r=new XMLHttpRequest,this._config.withCredentials&&(r.withCredentials=this._config.withCredentials),n||(r.onload=y(this._chunkLoaded,this),r.onerror=y(this._chunkError,this)),r.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var t in e)r.setRequestHeader(t,e[t])}if(this._config.chunkSize){var i=this._start+this._config.chunkSize-1;r.setRequestHeader("Range","bytes="+this._start+"-"+i)}try{r.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===r.status&&this._chunkError()}},this._chunkLoaded=function(){4===r.readyState&&(r.status<200||400<=r.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:r.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");if(null===t)return-1;return parseInt(t.substring(t.lastIndexOf("/")+1))}(r),this.parseChunk(r.responseText)))},this._chunkError=function(e){var t=r.statusText||e;this._sendError(new Error(t))}}function c(e){var r,n;(e=e||{}).chunkSize||(e.chunkSize=b.LocalChunkSize),u.call(this,e);var s="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,s?((r=new FileReader).onload=y(this._chunkLoaded,this),r.onerror=y(this._chunkError,this)):r=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var t=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,t)}var i=r.readAsText(e,this._config.encoding);s||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(r.error)}}function p(e){var i;u.call(this,e=e||{}),this.stream=function(e){return i=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,t=this._config.chunkSize;return t?(e=i.substring(0,t),i=i.substring(t)):(e=i,i=""),this._finished=!i,this.parseChunk(e)}}}function g(e){u.call(this,e=e||{});var t=[],i=!0,r=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=y(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=y(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=y(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=y(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function i(_){var a,o,h,r=Math.pow(2,53),n=-r,s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,u=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,t=this,i=0,f=0,d=!1,e=!1,l=[],c={data:[],errors:[],meta:{}};if(U(_.step)){var p=_.step;_.step=function(e){if(c=e,m())g();else{if(g(),0===c.data.length)return;i+=e.data.length,_.preview&&i>_.preview?o.abort():(c.data=c.data[0],p(c,t))}}}function v(e){return"greedy"===_.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function g(){if(c&&h&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+b.DefaultDelimiter+"'"),h=!1),_.skipEmptyLines)for(var e=0;e<c.data.length;e++)v(c.data[e])&&c.data.splice(e--,1);return m()&&function(){if(!c)return;function e(e,t){U(_.transformHeader)&&(e=_.transformHeader(e,t)),l.push(e)}if(Array.isArray(c.data[0])){for(var t=0;m()&&t<c.data.length;t++)c.data[t].forEach(e);c.data.splice(0,1)}else c.data.forEach(e)}(),function(){if(!c||!_.header&&!_.dynamicTyping&&!_.transform)return c;function e(e,t){var i,r=_.header?{}:[];for(i=0;i<e.length;i++){var n=i,s=e[i];_.header&&(n=i>=l.length?"__parsed_extra":l[i]),_.transform&&(s=_.transform(s,n)),s=y(n,s),"__parsed_extra"===n?(r[n]=r[n]||[],r[n].push(s)):r[n]=s}return _.header&&(i>l.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+l.length+" fields but parsed "+i,f+t):i<l.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+l.length+" fields but parsed "+i,f+t)),r}var t=1;!c.data.length||Array.isArray(c.data[0])?(c.data=c.data.map(e),t=c.data.length):c.data=e(c.data,0);_.header&&c.meta&&(c.meta.fields=l);return f+=t,c}()}function m(){return _.header&&0===l.length}function y(e,t){return i=e,_.dynamicTypingFunction&&void 0===_.dynamicTyping[i]&&(_.dynamicTyping[i]=_.dynamicTypingFunction(i)),!0===(_.dynamicTyping[i]||_.dynamicTyping)?"true"===t||"TRUE"===t||"false"!==t&&"FALSE"!==t&&(function(e){if(s.test(e)){var t=parseFloat(e);if(n<t&&t<r)return!0}return!1}(t)?parseFloat(t):u.test(t)?new Date(t):""===t?null:t):t;var i}function k(e,t,i,r){var n={type:e,code:t,message:i};void 0!==r&&(n.row=r),c.errors.push(n)}this.parse=function(e,t,i){var r=_.quoteChar||'"';if(_.newline||(_.newline=function(e,t){e=e.substring(0,1048576);var i=new RegExp(q(t)+"([^]*?)"+q(t),"gm"),r=(e=e.replace(i,"")).split("\r"),n=e.split("\n"),s=1<n.length&&n[0].length<r[0].length;if(1===r.length||s)return"\n";for(var a=0,o=0;o<r.length;o++)"\n"===r[o][0]&&a++;return a>=r.length/2?"\r\n":"\r"}(e,r)),h=!1,_.delimiter)U(_.delimiter)&&(_.delimiter=_.delimiter(e),c.meta.delimiter=_.delimiter);else{var n=function(e,t,i,r,n){var s,a,o,h;n=n||[",","\t","|",";",b.RECORD_SEP,b.UNIT_SEP];for(var u=0;u<n.length;u++){var f=n[u],d=0,l=0,c=0;o=void 0;for(var p=new w({comments:r,delimiter:f,newline:t,preview:10}).parse(e),g=0;g<p.data.length;g++)if(i&&v(p.data[g]))c++;else{var m=p.data[g].length;l+=m,void 0!==o?0<m&&(d+=Math.abs(m-o),o=m):o=m}0<p.data.length&&(l/=p.data.length-c),(void 0===a||d<=a)&&(void 0===h||h<l)&&1.99<l&&(a=d,s=f,h=l)}return{successful:!!(_.delimiter=s),bestDelimiter:s}}(e,_.newline,_.skipEmptyLines,_.comments,_.delimitersToGuess);n.successful?_.delimiter=n.bestDelimiter:(h=!0,_.delimiter=b.DefaultDelimiter),c.meta.delimiter=_.delimiter}var s=E(_);return _.preview&&_.header&&s.preview++,a=e,o=new w(s),c=o.parse(a,t,i),g(),d?{meta:{paused:!0}}:c||{meta:{paused:!1}}},this.paused=function(){return d},this.pause=function(){d=!0,o.abort(),a=U(_.chunk)?"":a.substring(o.getCharIndex())},this.resume=function(){t.streamer._halted?(d=!1,t.streamer.parseChunk(a,!0)):setTimeout(t.resume,3)},this.aborted=function(){return e},this.abort=function(){e=!0,o.abort(),c.meta.aborted=!0,U(_.complete)&&_.complete(c),a=""}}function q(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function w(e){var O,D=(e=e||{}).delimiter,I=e.newline,T=e.comments,A=e.step,L=e.preview,F=e.fastMode,z=O=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(z=e.escapeChar),("string"!=typeof D||-1<b.BAD_DELIMITERS.indexOf(D))&&(D=","),T===D)throw new Error("Comment character same as delimiter");!0===T?T="#":("string"!=typeof T||-1<b.BAD_DELIMITERS.indexOf(T))&&(T=!1),"\n"!==I&&"\r"!==I&&"\r\n"!==I&&(I="\n");var M=0,j=!1;this.parse=function(a,t,i){if("string"!=typeof a)throw new Error("Input must be a string");var r=a.length,e=D.length,n=I.length,s=T.length,o=U(A),h=[],u=[],f=[],d=M=0;if(!a)return R();if(F||!1!==F&&-1===a.indexOf(O)){for(var l=a.split(I),c=0;c<l.length;c++){if(f=l[c],M+=f.length,c!==l.length-1)M+=I.length;else if(i)return R();if(!T||f.substring(0,s)!==T){if(o){if(h=[],b(f.split(D)),S(),j)return R()}else b(f.split(D));if(L&&L<=c)return h=h.slice(0,L),R(!0)}}return R()}for(var p=a.indexOf(D,M),g=a.indexOf(I,M),m=new RegExp(q(z)+q(O),"g"),_=a.indexOf(O,M);;)if(a[M]!==O)if(T&&0===f.length&&a.substring(M,M+s)===T){if(-1===g)return R();M=g+n,g=a.indexOf(I,M),p=a.indexOf(D,M)}else{if(-1!==p&&(p<g||-1===g)){if(!(p<_)){f.push(a.substring(M,p)),M=p+e,p=a.indexOf(D,M);continue}var v=x(p,_,g);if(v&&void 0!==v.nextDelim){p=v.nextDelim,_=v.quoteSearch,f.push(a.substring(M,p)),M=p+e,p=a.indexOf(D,M);continue}}if(-1===g)break;if(f.push(a.substring(M,g)),C(g+n),o&&(S(),j))return R();if(L&&h.length>=L)return R(!0)}else for(_=M,M++;;){if(-1===(_=a.indexOf(O,_+1)))return i||u.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:h.length,index:M}),E();if(_===r-1)return E(a.substring(M,_).replace(m,O));if(O!==z||a[_+1]!==z){if(O===z||0===_||a[_-1]!==z){-1!==p&&p<_+1&&(p=a.indexOf(D,_+1)),-1!==g&&g<_+1&&(g=a.indexOf(I,_+1));var y=w(-1===g?p:Math.min(p,g));if(a[_+1+y]===D){f.push(a.substring(M,_).replace(m,O)),a[M=_+1+y+e]!==O&&(_=a.indexOf(O,M)),p=a.indexOf(D,M),g=a.indexOf(I,M);break}var k=w(g);if(a.substring(_+1+k,_+1+k+n)===I){if(f.push(a.substring(M,_).replace(m,O)),C(_+1+k+n),p=a.indexOf(D,M),_=a.indexOf(O,M),o&&(S(),j))return R();if(L&&h.length>=L)return R(!0);break}u.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:h.length,index:M}),_++}}else _++}return E();function b(e){h.push(e),d=M}function w(e){var t=0;if(-1!==e){var i=a.substring(_+1,e);i&&""===i.trim()&&(t=i.length)}return t}function E(e){return i||(void 0===e&&(e=a.substring(M)),f.push(e),M=r,b(f),o&&S()),R()}function C(e){M=e,b(f),f=[],g=a.indexOf(I,M)}function R(e){return{data:h,errors:u,meta:{delimiter:D,linebreak:I,aborted:j,truncated:!!e,cursor:d+(t||0)}}}function S(){A(R()),h=[],u=[]}function x(e,t,i){var r={nextDelim:void 0,quoteSearch:void 0},n=a.indexOf(O,t+1);if(t<e&&e<n&&(n<i||-1===i)){var s=a.indexOf(D,n);if(-1===s)return r;n<s&&(n=a.indexOf(O,n+1)),r=x(s,n,i)}else r={nextDelim:e,quoteSearch:t};return r}},this.abort=function(){j=!0},this.getCharIndex=function(){return M}}function m(e){var t=e.data,i=a[t.workerId],r=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var n={abort:function(){r=!0,_(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(U(i.userStep)){for(var s=0;s<t.results.data.length&&(i.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},n),!r);s++);delete t.results}else U(i.userChunk)&&(i.userChunk(t.results,n,t.file),delete t.results)}t.finished&&!r&&_(t.workerId,t.results)}function _(e,t){var i=a[e];U(i.userComplete)&&i.userComplete(t),i.terminate(),delete a[e]}function v(){throw new Error("Not implemented.")}function E(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var i in e)t[i]=E(e[i]);return t}function y(e,t){return function(){e.apply(t,arguments)}}function U(e){return"function"==typeof e}return o&&(f.onmessage=function(e){var t=e.data;void 0===b.WORKER_ID&&t&&(b.WORKER_ID=t.workerId);if("string"==typeof t.input)f.postMessage({workerId:b.WORKER_ID,results:b.parse(t.input,t.config),finished:!0});else if(f.File&&t.input instanceof File||t.input instanceof Object){var i=b.parse(t.input,t.config);i&&f.postMessage({workerId:b.WORKER_ID,results:i,finished:!0})}}),(l.prototype=Object.create(u.prototype)).constructor=l,(c.prototype=Object.create(u.prototype)).constructor=c,(p.prototype=Object.create(p.prototype)).constructor=p,(g.prototype=Object.create(u.prototype)).constructor=g,b});
</script>
<script type="text/javascript">
/*Copyright Samuel McKay 2021*/
/*This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 2 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>*/
  var container=document.getElementById("container0");
  var canvas = document.getElementById("canvas0");
  var ctx = canvas.getContext("2d");
  var fontSize = 10;
  var fontStyle='px Arial, sans-serif'
  var font=fontSize+fontStyle;
  var labelFontSize=fontSize;
  var labelFont=labelFontSize+fontStyle;
  var yAxisFontSize=16;
  var yAxisFont=yAxisFontSize+fontStyle;
  var buffer=10;
  var graphXOffset = 50;
  var graphYOffset = canvas.height-50;
  var reads;
  var scale=2;
  var maxwidth=818;
  var maxheight=600;
  var refLine1;
  var refLine1Color;
  var refLine2;
  var refLine2Color;
  var minVolt=0;
  var maxVolt=-1.6;
  var voltRange=minVolt-maxVolt;
  var voltIncrement=0.2;
  var graphCount=1;
  var textOverflow=50;
  var pxPerBar=100;
  var scaleFactor=0;
  var lineNames=[];
  var lineColors=[];
  var skipThreshold;
  var dpi=96;
  var startFoot;
  var footOffset=0;
  var lineCount;
  var pxScale;
  var unit=100;
  var labelHeight=6;
  var prevValue=0;
  var startAt=0;
  var endAt=0;
  var dotWidth=1;
  //takes csv and loads it into reads[]
  function loadFile(){
    var file = document.getElementById("fileToLoad").files[0];
    Papa.parse(file, {
	    complete: function(results) {
		    console.log("Finished:", results.data);
        reads=results.data;
        //sometimes the end of file gets counted as a record
        //the following if removes the faux record at end of file
        if(reads[reads.length-1].length==1)
            reads.pop();
        clearGraphs();
        config();
        convertNumbers();
        initializeGraph(0);
	      }
    });
  }
  function clearGraphs() {
    var graphs=document.getElementsByClassName('container');
    for(var i=graphs.length-1;i>0;--i){
      graphs[i].remove();
    }
    //headers and Y-axis
    document.getElementById("box1").innerHTML="";
    document.getElementById("box2").innerHTML="";
    document.getElementById("box3").innerHTML="";

    document.getElementById("box5").innerHTML="Location: ";
    document.getElementById("box6").innerHTML="Survey Direction: ";
    document.getElementById("box7").innerHTML="Survey Type: ";
    document.getElementById("box8").innerHTML="Survey Date: ";

    document.getElementById("box9").innerHTML="Interruption Cycle: ";
    document.getElementById("box10").innerHTML="On Setup: ";
    document.getElementById("box11").innerHTML="Off Delay: ";
    document.getElementById("box12").innerHTML="Cycle Begins With: ";

    document.getElementById("box13").innerHTML="Feet/Inch";
    var legends=document.getElementsByClassName("legend");
    for (var i=0;i<legends.length;i++){
      legends[i].innerText="___";
      legends[i].style.display="none";
    }
  }
  function initializeGraph(graphIndex){
    moveToGraph(graphIndex,false);
    ctx.clearRect(0,0,canvas.width,canvas.height);
    //draws vertical grid lines every pxPerBar pixels
    for (var i = 0; i < graphYOffset; i++) {
      drawPoint(graphXOffset, i, 'black');
      if (i % (2*dotWidth) == 0&i<graphYOffset){
        for(var k=1;k<=(maxwidth-textOverflow)/(pxPerBar);k++){
          drawPoint(graphXOffset + (pxPerBar*k),i,'gray');
        }
      }
    }
    //draws horizontal grid lines at every voltIncrement
    for (var i = 0; i < maxwidth; i++) {
      if (i>graphXOffset){
        drawPoint(i, graphYOffset, 'black');
        //i%2==0 makes the line dotted
        if(i%(2*dotWidth)==0){
          for(var k=1;k<voltRange/voltIncrement;k++){
            drawPoint(i,graphYOffset - (voltIncrement*k / voltRange) * graphYOffset,'gray')
          }
          drawPoint(i, graphYOffset - ((refLine1+minVolt) / voltRange) * graphYOffset, refLine1Color);
          drawPoint(i, graphYOffset - ((refLine2+minVolt) / voltRange) * graphYOffset, refLine2Color);
        }
      }   
    }
    drawFootage(graphIndex);
    drawGrade(graphIndex);
  }
  function drawPoint(x, y, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x, y, 1, 1);
  }
  function drawComments(color) {
    moveToGraph(0,true);
    var currentXOffset=graphXOffset-(startFoot*scaleFactor);
    //leftmost tracks the left most a comment can be rendered while not colliding with other comments
    leftmost = graphXOffset;
    var graphIndex=0;
    ctx.save();
    ctx.font = font;
    ctx.strokeStyle='black';
    ctx.fillStyle = color;
    ctx.textAlign = 'right';
    var commentIndex=lineCount+1;
    for (var i = 0; i < reads.length; i++) {
      //x tracks the x coordinate of the comment pointer line
      x=reads[i][0]*scaleFactor+currentXOffset;
      if (reads[i][commentIndex].length > 0) {
        //ensures comments don't overlap
        leftmost=x>leftmost+buffer?x:leftmost+buffer;
        //moves comment to next graph because it has reached the maximum x
        if(leftmost>canvas.width||x>maxwidth){
          currentXOffset-=maxwidth-graphXOffset;
          leftmost-=maxwidth-graphXOffset;
          x-=maxwidth-graphXOffset;
          graphIndex++;
          moveToGraph(graphIndex,true);
        }

        drawFoot(x,leftmost,reads[i][0]);

        //ensures comment does not collide with y-axis
        leftmost= leftmost-graphXOffset < buffer? buffer+graphXOffset : leftmost;
        
        var metrics = ctx.measureText(reads[i][commentIndex]);
        // x and y are flipped because ctx is rotated -90 degrees
        ctx.fillText(reads[i][commentIndex], -graphYOffset + metrics.width+buffer, leftmost);
        //draws line from comment to x-axis
        ctx.beginPath();
        ctx.moveTo(-graphYOffset + buffer, leftmost);
        ctx.lineTo(-graphYOffset, x);
        ctx.stroke();
        ctx.moveTo(0, 0);
        
        //removes footage after end of line
        if(i==reads.length-2){
          //ctx.clearRect(-graphYOffset,x,graphXOffset+maxwidth,graphYOffset);
        }
      }
    }

    ctx.restore();

  }
  function drawFootage(graphIndex){
    ctx.save();
    moveToGraph(graphIndex,true);
    
    ctx.font = yAxisFont;
    ctx.fillStyle = 'black';
    ctx.textAlign = 'right';
    //draws the y-axis label; 
    //placed here for convience because the ctx is already rotated and this runs after the graph has been cleared
    var yAxis=document.getElementById("box3").innerText;
    var metrix=ctx.measureText(yAxis);
    ctx.fillText(yAxis,(graphYOffset-metrix.width)/-2,metrix.actualBoundingBoxAscent);

    ctx.font=labelFont;
    //draws foot labels every pxPerBar pixels
    for(var j=0;j<=(maxwidth-textOverflow)/(pxPerBar);j++){
      pxScale=pxPerBar/dpi;
      var footage=(j*pxScale+((graphIndex*8)))*unit/scale+startFoot;
      ctx.fillText(formatFoot(footage)+" ",-graphYOffset,pxPerBar*j+graphXOffset+labelHeight/2);
    }
    ctx.restore();
  }
  function drawGrade(graphIndex){
    ctx.save();
    moveToGraph(graphIndex,false);
    ctx.font=labelFont;
    ctx.fillStyle = 'black';
    ctx.textAlign = 'right';
    
    for(var j=0;j<voltRange/voltIncrement;j++){
      //draws volt labels at every voltIncrement between minVolt and maxVolt
      ctx.fillText((minVolt-voltIncrement*j).toFixed(1)+" ",graphXOffset,graphYOffset - (voltIncrement*j / voltRange) * graphYOffset+3);
        for(var i=0;i<5;i++){
          //draws y-axis ticks halfway between volt increments
          drawPoint(graphXOffset-i,graphYOffset-((voltIncrement/voltRange)*(j+0.5)) * graphYOffset);
        }
    }
    ctx.restore();   
  }
  //loads the config settings into variables
  function config() {
    for(var i=1;i<=12;i++){
      var box = document.getElementById('box'+i);
      var input = document.getElementById('input'+i);
      box.innerHTML+=input.value;
    }
    var box13=document.getElementById('box13');
    scale=document.getElementById('config2').value*1;
    
    box13.innerHTML=(unit/scale)+" "+box13.innerHTML;
    fontSize=document.getElementById('config1').value;
    font=fontSize+fontStyle;
    pxPerBar=document.getElementById('config3').value;
    skipThreshold=document.getElementById('config4').value;
    
    minVolt=document.getElementById('config5').value*1;
    maxVolt=document.getElementById('config6').value*1;
    voltRange=minVolt-maxVolt;
    voltIncrement=document.getElementById('config7').value;
    lineCount=document.getElementById('config8').value*1;

    refLine1=document.getElementById('config9').value*-1;
    refLine1Color=document.getElementById('config10').value;
    refLine2=document.getElementById('config11').value*-1;
    refLine2Color=document.getElementById('config12').value;

    startAt=document.getElementById('config13').value*1;
    endAt=document.getElementById('config14').value*1;
    startIndex=0;
    endIndex=0;
    if(startAt>0||endAt>0){
        for(var i=0;i<reads.length;i++){
            if(startAt<=reads[i][0]&startIndex==0)
                startIndex=i;
            if(endAt<=reads[i][0]&endIndex==0)
                endIndex=i+1;
            
        }
        if(endAt<1)
            endIndex=reads.length;
        reads=reads.slice(startIndex,endIndex);
    }
    scaleFactor=document.getElementById('config15').value*scale/unit;
    setDPI();
    lineColors=[];
    for(var i=0;i<lineCount;i++){
      var lineName=(document.getElementById('lineName'+i).value);
      var lineColor=(document.getElementById('lineColor'+i).value);
      var legend=document.getElementById('legend'+i);
      legend.innerHTML+=lineName;
      legend.style.color=lineColor;
      legend.style.display="";
      lineColors.push(lineColor);
      lineNames.push(lineName);
    }    
  }
  function drawLines(){
    for(var i=0;i<lineCount;i++){
      drawLine(lineColors[i],i+1);
    }
  }
  function drawLine(color,index) {
    moveToGraph(0,false);
    var graphIndex=0;
    nextX = 1 + graphXOffset;
    nextY = graphYOffset + ((reads[0][index]-minVolt) / voltRange) * graphYOffset;
    var currentXOffset=graphXOffset-(startFoot*dpi*scale)/unit;
    ctx.save();
    ctx.strokeStyle = color;
    for (var i = 0; i < reads.length; i++) {
      if(i>0){
        //ensures the trend line is not drawn across gaps by setting the x,y and doing nothing
        if(reads[i][0]-reads[i-1][0]>skipThreshold||reads[i-1][index]==0){
          nextX = reads[i][0]*scaleFactor + currentXOffset;
          nextY = graphYOffset + ((reads[i][index]-minVolt)/voltRange) * graphYOffset;  
        }
      }
      //moves the line to the next graph when exceeding the maxWidth
      if(nextX>maxwidth){
        currentXOffset-= maxwidth-graphXOffset;
        graphIndex++;
        moveToGraph(graphIndex,false);
        nextX += graphXOffset-maxwidth;
        ctx.strokeStyle=color;
      }
      //ensures when the trend line does not start at 0 there is not a line from 0 to the start of the line
      else if(i==0&footOffset>1){
        drawFoot(nextX,'black');
        nextX = reads[i][0]*scaleFactor + currentXOffset;
        nextY = graphYOffset + ((reads[i][index]-minVolt)/voltRange) * graphYOffset; 
      }
      //draws the trendline
      else{
        ctx.beginPath();
        ctx.moveTo(nextX, nextY);
        nextX = reads[i][0]*scaleFactor + currentXOffset;
        nextY = graphYOffset + ((reads[i][index]-minVolt)/voltRange) * graphYOffset;
        ctx.lineTo(nextX, nextY);
        ctx.stroke();
      }

    }
    ctx.restore();
  }
  function drawFoot(x,textX,value){
    var ftPerBar=pxScale*unit/scale;
    var ftBuffer=10;
    //returns if value is within the buffer of a pre-drawn foot mark
    if(value%ftPerBar<ftBuffer/scale||value%ftPerBar>ftPerBar-ftBuffer/scale){
      return;
    }
    if(value-prevValue<ftBuffer/scale){
      return;
    }
    prevValue=value;
    ctx.save();
    ctx.font = labelFont;
    ctx.fillStyle = 'black';
    ctx.textAlign = 'right';
    //3 needs to be replaced with a variable
    ctx.fillText(formatFoot(value)+" ",-graphYOffset,x+3);
    ctx.restore();

  }
  function convertNumbers(){
    for(var i=0;i<reads.length;i++){
      for(var j=0; j < lineCount+1;j++){
        //makes the trend lines and footage behave like numbers
        reads[i][j]=reads[i][j]*1;
      }
      //forces the comments to be strings
      reads[i][lineCount+1]+="";
    }
    //makes the graphs start at largest hundred below the first footage mark
    startFoot=Math.floor(reads[0][0]*1/100);
    startFoot*=100;
    footOffset=reads[0][0]%100;
  }
  //takes properties of the current ctx and canvas 
  //and assigns them to target ctx and canvas
  //and sets the target ctx and canvas to be current
  function moveToGraph(ID,rotated){
    strokeStyle=ctx.strokeStyle;
    fillStyle=ctx.fillStyle;
    textAlign=ctx.textAlign;
    width=canvas.width;
    height=canvas.height;
    ctxFont=ctx.font;
    ctx.restore();
    canvas=document.getElementById('canvas'+ID);
    //creates the graph if it doesn't exist
    if(canvas==null){
      container=document.getElementById('container0');
      newContainer=container.cloneNode(true);
      newContainer.id="container"+ID;
      spans=newContainer.getElementsByTagName('span');
      spans[spans.length-1].innerHTML="Page "+(ID+1);
      newContainer.getElementsByTagName("canvas")[0].id="canvas"+ID;
      container.parentNode.appendChild(newContainer);
      canvas=document.getElementById('canvas'+ID);
      initializeGraph(ID);
    }
    ctx=canvas.getContext("2d");
    ctx.strokeStyle;
    ctx.strokeStyle=strokeStyle;
    ctx.fillStyle=fillStyle;
    ctx.textAlign=textAlign;
    ctx.font=ctxFont
    ctx.resetTransform();
    //rotating outside of this function should be avoided
    if(rotated){
      ctx.moveTo(0,0);
      ctx.rotate(-Math.PI/2);

    }

  }
  function toggleConfig(){
    var config=document.getElementById('config');
    var toggle=document.getElementById('toggleConfig');
    if(toggle.checked){
      config.style.display="";
    }
    else{
      config.style.display="none";
    }
  }
  function setDPI(){
    dpiTarget=document.getElementById('config15').value*1;
    canvas.style.width = canvas.style.width || canvas.width + 'px';
    canvas.style.height = canvas.style.height || canvas.height + 'px';

    dpiScale=dpiTarget/dpi;
    canvas.width=Math.ceil(canvas.width*dpiScale);
    canvas.height=Math.ceil(canvas.height*dpiScale);
    ctx.scale(dpiScale,dpiScale);
    
    dpi=dpiTarget;
    buffer*=dpiScale;
    
    graphXOffset*=dpiScale;
    graphYOffset*=dpiScale;
    maxwidth*=dpiScale;
    maxheight*=dpiScale;
    textOverflow*=dpiScale;

    dotWidth*=dpiScale;
    
    labelHeight*=dpiScale;
    
    labelFontSize*=dpiScale;
    labelFont=labelFontSize+fontStyle;
    
    fontSize*=dpiScale;
    font=fontSize+fontStyle;
    ctx.font=font;
    
    yAxisFontSize*=dpiScale;
    yAxisFont=yAxisFontSize+fontStyle;
  }
  //places a '+' between the hundreds and tens of an integer
  //eg: 1000 -> 10+00
  function formatFoot(foot){
    left=Math.floor(foot/100);
    right=foot%100==0?"0":Math.ceil(foot%100);
    right=right<10?"0"+right:right;
    return left+"+"+right;
  }
</script>

</html>
